<!DOCTYPE html>
  <html>
    <head>
      <title>GGR272 Assignment 4</title>

      <!-- Load CARTO VL JS -->
      <script src="https://libs.cartocdn.com/carto-vl/v1.2.4/carto-vl.min.js"></script>
      <!-- Load Mapbox GL -->
      <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v1.0.0/mapbox-gl.js"></script>
      <link href="https://api.tiles.mapbox.com/mapbox-gl-js/v1.0.0/mapbox-gl.css" rel="stylesheet" />
      <!-- Load CARTO VL Styles -->
      <link href="https://carto.com/developers/carto-vl/v1.4.2/examples/maps/style.css" rel="stylesheet">
      <style>
        #map {
          position: absolute;
          width: 100%;
          height: 100%;
        }
      </style>
    </head>
    <body>
      <div id="map"></div>
    </body>
    <script>
      const map = new mapboxgl.Map({
        container: 'map',
        style: carto.basemaps.voyager,
        center: [-79.6441, 43.5991],
        zoom: 10.75,
        scrollZoom: true
      });

      const nav = new mapboxgl.NavigationControl({
        showCompass: true
      });

      map.addControl(nav, 'top-left');
      map.addControl(new mapboxgl.FullscreenControl(), 'top-left');

      // Define user
      carto.setDefaultAuth({
        username: 'sagerydaer',
        apiKey: 'default_public'
      });

      // Define layer
      const boundary_source = new carto.source.Dataset('municipal_boundary');
      const boundary_viz = new carto.Viz();
      const municipal_boundary = new carto.Layer('municipal_boundary', boundary_source, boundary_viz);

      // Define layer
      const rent_source = new carto.source.Dataset('average_rent');
      const rent_viz = new carto.Viz(`
        color: ramp(globalEqIntervals($col1, 5), teal)
        strokeColor: rgba(0,0,0,0.2)
        strokeWidth: 1
      `);
      const average_rent = new carto.Layer('average_rent', rent_source, rent_viz);

      // Define layer
      const pse_source = new carto.source.Dataset('export_output_2');
      const pse_viz = new carto.Viz(`
        color: rgba(0,0,255,0.5)
        strokeWidth: 1
        `);
      const pse = new carto.Layer('pse', pse_source, pse_viz);

      // Define layer
      const eat_buffer_source = new carto.source.Dataset('eateries_as_buffer');
      const eat_buffer_viz = new carto.Viz(`
        color: rgba(255,0,0,0.5)
        width: ramp(zoomrange([12.5,12.6]),[45,0])
        strokeWidth: 0
        `);
      const eateries_as_buffer = new carto.Layer('eat_buffer_source',eat_buffer_source,eat_buffer_viz);

      const Eatlocs_source = new carto.source.Dataset('eateriesnoxmin');
      const Eatlocs_viz = new carto.Viz(`
        color: rgba(255,0,0,0.7)
        width: ramp(zoomrange([12.5,12.6]),[0,8])
        strokeWidth: ramp(zoomrange([12.5,12.6]),[0,0.5])
        `)
      const eats_locations = new carto.Layer('eateriesnoxmin', Eatlocs_source, Eatlocs_viz);

      // Add the layers to the map
      municipal_boundary.addTo(map, 'watername_ocean');
      average_rent.addTo(map, 'watername_ocean');
      eateries_as_buffer.addTo(map, 'watername_ocean');
      eats_locations.addTo(map,'watername_ocean');
      pse.addTo(map, 'watername_ocean');






    </script>
  </html>
